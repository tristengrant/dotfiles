#!/bin/sh

# Display and DPI setup
xrandr --dpi 96
autorandr --change

# GTK/Qt theming
export GTK_USE_PORTAL=0
export GTK_THEME="Orchis-Grey-Dark"
export ICON_THEME="Colloid-Grey-Dracula-Dark"
export QT_QPA_PLATFORMTHEME=qt5ct

# Cursor
export XCURSOR_THEME=Adwaita
export XCURSOR_SIZE=24

# Ensure ~/bin is in PATH
export PATH="$HOME/bin:$PATH"

# Load X resources (fonts, colors, etc.)
[ -f ~/.Xresources ] && xrdb -merge ~/.Xresources

# Disable bell, DPMS, and screen blanking
xset b off
xset -dpms
xset s noblank
# Set default pointer
xsetroot -cursor_name left_ptr

# XDG user dirs
xdg-user-dirs-update

# Keyring
eval "$(gnome-keyring-daemon --start --components=pkcs11,secrets,ssh,gpg)"
export SSH_AUTH_SOCK

# Polkit authentication agent
lxpolkit &

# Compositor
picom --experimental-backends -b

# Wallpaper
feh --bg-fill --randomize ~/Pictures/wallpapers/* &

# Background services
syncthing --no-browser &
udiskie &
nm-applet &
slstatus &
dunst &

# Thunar helper
thunar --daemon &

# XFCE helper daemons for GTK settings
/usr/libexec/xfce4/xfconfd &
/usr/libexec/xfce4/xfsettingsd &

# Tablet setup (if needed)
# ~/bin/tablet_setup.sh &

# Start window manager
(sleep 2; exec dwm)
